{
  "$schema": "../../../../lib3/projects/page/schema.json",
  "navs": [
    {
      "type": "tree",
      "title": "部门树",
      "api": "apis.deptlist",
      "nameKey": "depName",
      "parentKey": "supId",
      "mappingKey": "departmentId"
    }
  ],
  "table": {
    "title": "Windows主机列表",
    "view": {
      "api": "apis.hostlist",
      "body": {
        "exact": {
          "hostType": 130102
        }
      },
      "columns": [
        {
          "label": "主机名称",
          "key": "resName",
          "search": true
        },
        {
          "label": "主机IP",
          "key": "resIpV4",
          "search": true
        },
        {
          "label": "资产组",
          "key": "depName"
        }
      ]
    },
    "form": [
      {
        "cols": 2,
        "beforeOpen": "d=>{d.wintype=d.winType; d.windomaindn=d.winDomainDn;d.windomainname=d.winDomainName;}",
        "fields": [
          {
            "type": "treeselect",
            "label": "资产组",
            "key": "departmentId",
            "treeselect": {
              "api": "apis.deptlist",
              "nameKey": "depName",
              "parentKey": "supId"
            }
          },
          {
            "type": "input",
            "label": "主机名称",
            "key": "resName",
            "required": true
          },
          {
            "type": "input",
            "label": "主机IP",
            "key": "resIpV4",
            "required": true
          },
          {
            "type": "select",
            "label": "主机类型",
            "key": "wintype",
            "required": true,
            "select": {
              "api": "apis.dictlist",
              "body": {
                "exact": {
                  "supId": 1308,
                  "dicStatus": 1
                }
              },
              "nameKey": "dicName"
            }
          },
          {
            "type": "input",
            "label": "域名",
            "key": "windomainname",
            "required": true,
            "show": "d=>d.wintype==130801"
          },
          {
            "type": "input",
            "label": "域控DN",
            "key": "windomaindn",
            "required": true,
            "show": "d=>d.wintype==130801"
          },
          {
            "type": "modal",
            "label": "域控主机",
            "key": "winDomainResId",
            "required": true,
            "show": "d=>d.wintype==130803",
            "nameKey": "winDomainName",
            "modal": {
              "nameKey": "resName",
              "view": {
                "api": "apis.hostlist",
                "multiple": false,
                "columns": [
                  {
                    "label": "主机名称",
                    "key": "resName"
                  },
                  {
                    "label": "主机IP",
                    "key": "resIpV4"
                  }
                ]
              }
            }
          },
          {
            "type": "select",
            "label": "服务",
            "key": "services",
            "value": ["RDP"],
            "required": true,
            "select": {
              "multiple": true,
              "options": [
                {
                  "label": "RDP",
                  "value": "RDP"
                },
                {
                  "label": "SSH",
                  "value": "SSH"
                },
                {
                  "label": "TELNET",
                  "value": "TELNET"
                }
              ]
            }
          },
          {
            "type": "modal",
            "label": "资产管理员",
            "key": "resManagerUserId",
            "nameKey": "uname",
            "modal": {
              "title": "选择用户",
              "key": "uid",
              "nameKey": "uname",
              "view": {
                "api": "apis.userlist",
                "multiple": false,
                "columns": [
                  {
                    "label": "用户名",
                    "key": "uid",
                    "search": true
                  },
                  {
                    "label": "姓名",
                    "key": "uname",
                    "search": true
                  }
                ]
              }
            }
          },
          {
            "type": "modal",
            "label": "跳转机",
            "key": "unixResSkipId",
            "nameKey": "skipName",
            "modal": {
              "nameKey": "resName",
              "view": {
                "api": "apis.hostlist",
                "multiple": false,
                "columns": [
                  {
                    "label": "主机名称",
                    "key": "resName"
                  },
                  {
                    "label": "主机IP",
                    "key": "resIpV4"
                  }
                ]
              }
            }
          },
          {
            "type": "select",
            "label": "系统类型",
            "key": "hostSystemType",
            "select": {
              "api": "apis.dictlist",
              "body": {
                "exact": {
                  "supId": 130102,
                  "dicStatus": 1
                }
              },
              "nameKey": "dicName"
            }
          },
          {
            "type": "select",
            "label": "生产厂家",
            "key": "dicManufactorId",
            "select": {
              "api": "apis.dictlist",
              "body": {
                "exact": {
                  "supId": 14,
                  "dicStatus": 1
                }
              },
              "nameKey": "dicName"
            }
          },
          {
            "type": "textarea",
            "label": "描述",
            "key": "zDesc"
          }
        ]
      }
    ],
    "create": {
      "api": "apis.hostcreate"
    },
    "update": {
      "api": "apis.hostupdate"
    },
    "delete": {
      "api": "apis.hostdelete",
      "body": {
        "id": "$this.data[this.key]$"
      }
    }
  }
}
